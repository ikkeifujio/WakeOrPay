# WakeOrPay

アラームが鳴ったら **1分以内にQRをスキャン。成功すれば停止、失敗なら自動でSMSを送信して自分を追い込む目覚ましアプリ。

## デモ
[▶️ 成功デモ（動画）](![9188AD85-3C10-4733-A851-B1DF5F545164_1_201_a](https://github.com/user-attachments/assets/7c03071f-8971-403e-a4ff-98de4523101b))　|　[▶️ 失敗デモ（動画作成中）

<p align="center">
  <img src="./Demos/success.gif" width="300" />
  <img src="./Demos/failure.gif" width="300" />
</p>

## スクリーンショット
<p align="center">

  <b>使い方ボタン押下で表示</b><br/>
  <img src="./images/97C88BF1-565C-4B1E-A4F2-FC59D2334909_1_102_o.jpeg" width="300" />
  <img src="./images/4608DF88-F7F4-4917-B8F5-BB3BF07B0F1E_1_102_o.jpeg" width="300" /><br/><br/>

  <b>設定ボタン押下で表示</b><br/>
  <img src="./images/C5FCCBF5-9EEE-4839-8CA7-1F8743A5B2C0_1_102_o.jpeg" width="300" />
  <img src="./images/6C8E6990-44AC-4C99-96A5-3DEC6C6A1620_1_102_o.jpeg" width="300" /><br/><br/>

  <b>＋ボタン押下で表示</b><br/>
  <img src="./images/57EBDF97-CE01-4FAA-B8AB-5548DB2D6C0C_1_102_o.jpeg" width="300" />

</p>


## 解決したい課題 
アラームを無意識に止めて二度寝してしまう問題

スマホの標準アラームは「スヌーズ」「停止ボタン」をワンタップで操作できてしまいます。
意識が朦朧としていると、無意識にアラームを止めてしまい、結局二度寝してしまうことがあります。
WakeOrPay は QRコードをスキャンしないとアラームを止められない仕組みで、物理的に移動を促し、強制的に目を覚まさせます。

## 機能
- アラーム設定・鳴動
- 1分カウントダウン
- QRコードスキャンで停止
- タイムアウトで失敗ダイアログ＋SMS自動送信
- ローカル通知 / サーバーWebhook連携
- 成功: 1分以内のスキャン／失敗: タイムアウト→SMS自動送信

## アーキテクチャ / 技術スタック
Swift/SwiftUI: ネイティブ性能とUIの美しさ
MVVM: 状態管理の一元化でバグ防止
Vercel + Twilio: サーバーレスで確実なSMS送信
UserNotifications: システムレベルの確実な通知

## 実装の工夫
- **状態の一元化**：成功/失敗は `AlarmState` のみで確定
- **時間基準カウントダウン**：`fireDate`から算出（音の成否に非依存）
- **QR厳格検証**：`expectedQR`一致＋1分以内のみ成功

## 使い方
1. アラーム時刻を設定
2. 鳴動後、1分カウント開始
3. QRをスキャン → 成功ダイアログ／タイムアウト → 失敗＋SMS

## 既知の制約
- バックグラウンド実行の制約（iOS規約を遵守）
- サーバーURLが無効だとSMS送信は


さっき修正してもらったけど全く変わってないからまたお願い
①アプリ起動時に成功ダイアログは表示させないようにする 
②１分以内にスキャンされない（カウントダウンが0になる）と失敗ダイアログを表示し、SMSメッセージを自動送信する（自動送信できなければ送信の直前までいく。） 
③カウントダウンがなぜか表示されないため表示する 
